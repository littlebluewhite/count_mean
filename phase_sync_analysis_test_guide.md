# 分期同步分析功能測試指南

## 功能概述
分期同步分析功能可以同步分析三種不同採樣頻率的生物力學數據（Motion、EMG、力板），並根據選擇的分期點計算 EMG 訊號的平均值和最大值。

## 測試準備

### 必要檔案
1. **分期總檔案** (`分期總檔案.csv`)
   - 位置：`./input/分期總檔案.csv`
   - 包含所有主題的檔案映射和分期點信息

2. **數據檔案**（放在同一個資料夾內）
   - Motion 檔案：如 `NSF2_BTS_4_ok_20250419.data.csv`
   - EMG 檔案：如 `NSF_1.1_BTS_1.5_RMS0.020_0.019.csv`
   - 力板檔案：如 `NSF2_BTS_4.anc`

## 測試步驟

### 1. 啟動應用程式
```bash
# 在專案根目錄執行
wails dev
```

### 2. 進入分期同步分析功能
- 在主界面點擊「分期同步分析」按鈕（圖標：🔄）

### 3. 載入分期總檔案
- 點擊「瀏覽」按鈕或拖放分期總檔案
- 選擇 `./input/分期總檔案.csv`
- 系統會自動載入所有主題

### 4. 選擇數據資料夾
- 點擊「瀏覽」按鈕
- 選擇包含所有數據檔案的資料夾（如 `./input`）

### 5. 選擇分析參數
- **主題**：從下拉選單中選擇要分析的主題
- **開始分期點**：選擇分析的起始點（如 P0）
- **結束分期點**：選擇分析的結束點（如 P2）

### 6. 執行分析
- 點擊「開始分析」按鈕
- 等待分析完成

### 7. 查看結果
- 分析完成後會顯示：
  - 主題名稱
  - 分析時間範圍
  - 輸出檔案路徑
  - 詳細分析報告
- 結果會自動保存到 `./output` 目錄

## 輸出檔案格式
輸出的 CSV 檔案格式如下：
```
,Channel1,Channel2,Channel3,...
開始分期點,P0
開始時間,3.012
結束分期點,P2
結束時間,3.774
平均值,0.123456,0.456789,0.789012,...
最大值,0.234567,0.567890,0.890123,...
```

## 分期點說明
- **P0-P2**：準備期階段（力板時間）
- **S**：啟動瞬間（力板時間）
- **C**：下蹲加速減速轉換瞬間（力板時間）
- **D**：下蹲結束時間（Motion index）
- **T0**：正沖涼結束時間（力板時間）
- **T**：起跳瞬間（力板時間）
- **O**：展體轉間（Motion index）
- **L**：著地瞬間（力板時間）

## 錯誤處理
如果遇到以下錯誤：

1. **找不到檔案**
   - 確認分期總檔案中的檔案名稱正確
   - 確認數據資料夾路徑正確

2. **分期點無效**
   - 確認選擇的分期點在分期總檔案中有對應的值
   - 開始分期點必須在結束分期點之前

3. **數據格式錯誤**
   - 確認 CSV 檔案格式正確
   - 確認 ANC 檔案未損壞

## 建議測試案例

### 案例1：基本功能測試
- 主題：第一個主題（索引 0）
- 開始分期點：P0
- 結束分期點：P2
- 預期：成功計算並輸出統計結果

### 案例2：跨類型分期點測試
- 主題：任意主題
- 開始分期點：S（力板時間）
- 結束分期點：D（Motion index）
- 預期：正確轉換時間並計算

### 案例3：完整週期測試
- 主題：任意主題
- 開始分期點：P0
- 結束分期點：L
- 預期：分析整個運動週期

## 注意事項
1. 確保所有數據檔案的採樣頻率正確：
   - Motion: 250Hz
   - EMG: 1000Hz
   - 力板: 1000Hz

2. 檔案名稱必須與分期總檔案中記錄的完全一致

3. 輸出檔案會覆蓋同名檔案，請注意備份